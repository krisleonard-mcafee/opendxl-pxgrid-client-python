
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Basic Apply ANC Endpoint Policy by IP Address Example &#8212; Cisco pxGrid DXL Client Library 0.2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic Apply ANC Endpoint Policy by MAC Address Example" href="basicancapplyendpointpolicybymacexample.html" />
    <link rel="prev" title="Enable Cisco pxGrid Notifications for DXL" href="pxgridnotifications.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basicancapplyendpointpolicybymacexample.html" title="Basic Apply ANC Endpoint Policy by MAC Address Example"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pxgridnotifications.html" title="Enable Cisco pxGrid Notifications for DXL"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Cisco pxGrid DXL Client Library 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-apply-anc-endpoint-policy-by-ip-address-example">
<h1>Basic Apply ANC Endpoint Policy by IP Address Example<a class="headerlink" href="#basic-apply-anc-endpoint-policy-by-ip-address-example" title="Permalink to this headline">¶</a></h1>
<p>This sample applies a Cisco Adaptive Network Control (ANC) policy to an
endpoint via DXL and Cisco pxGrid. The sample identifies the endpoint by its IP
address.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">The samples configuration step has been completed (see <a class="reference internal" href="sampleconfig.html"><span class="doc">Samples Configuration</span></a>).</p>
</li>
<li><p class="first">The DXL fabric to which the client will connect has been bridged to Cisco
pxGrid.</p>
</li>
<li><p class="first">The Python client has been authorized to perform <code class="docutils literal notranslate"><span class="pre">DXL</span> <span class="pre">Cisco</span> <span class="pre">pxGrid</span> <span class="pre">Queries</span></code>
(see <a class="reference internal" href="pxgridauth.html"><span class="doc">Authorize Client to Use Cisco pxGrid via DXL</span></a>).</p>
</li>
<li><p class="first">A session has been established with the Cisco Identity Services Engine (ISE)
server for an endpoint. The endpoint's IP address will be used when running
this example. For an example on creating a simulated session for testing, see
the Cisco RADIUS Simulator command examples in
<a class="reference internal" href="basicidentitysessionnotificationexample.html"><span class="doc">Basic pxGrid Session Notification Example</span></a>.</p>
</li>
<li><p class="first">An ANC policy named <code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code> has been configured. The policy
could be created by logging into the ISE web interface and performing the
following steps:</p>
<blockquote>
<div><ul class="simple">
<li>Navigate to <strong>Operations</strong> → <strong>Adaptive Network Control</strong> →
<strong>Policy List</strong>.</li>
<li>On the <strong>List</strong> screen, click on the <strong>Add</strong> button.</li>
<li>On the <strong>List</strong> → <strong>New</strong> screen, enter <code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code> in the
<strong>name</strong> field, select <code class="docutils literal notranslate"><span class="pre">QUARANTINE</span></code> in the <strong>Action</strong> field, and press
the <strong>Submit</strong> button.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Update the following line in the sample:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HOST_IP</span> <span class="o">=</span> <span class="s2">&quot;&lt;SPECIFY_IP_ADDRESS&gt;&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>To specify the IP address of an endpoint for which to apply the
<code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code>. For example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HOST_IP</span> <span class="o">=</span> <span class="s2">&quot;192.168.1.1&quot;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h2>
<p>To run this sample execute the
<code class="docutils literal notranslate"><span class="pre">sample/basic/basic_anc_apply_endpoint_policy_by_ip_example.py</span></code> script as
follows:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">sample</span><span class="o">/</span><span class="n">basic</span><span class="o">/</span><span class="n">basic_anc_apply_endpoint_policy_by_ip_example</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div></blockquote>
<p>If the policy can be applied successfully, the output should appear similar to
the following:</p>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;ancStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>The received results are displayed.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code> has already been associated with the endpoint
before the example is run, an <code class="docutils literal notranslate"><span class="pre">Exception</span></code> should be raised and output similar
to the following should appear:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span><span class="p">:</span> <span class="n">mac</span> <span class="n">address</span> <span class="ow">is</span> <span class="n">already</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">this</span> <span class="n">policy</span> <span class="n">error</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">ip</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>If the <code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code> has not been defined before the example is run, an
<code class="docutils literal notranslate"><span class="pre">Exception</span></code> should be raised and output similar to the following should
appear:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span><span class="p">:</span> <span class="n">Policy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">configured</span> <span class="n">error</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">ip</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>If no session has been established for an endpoint which corresponds to the IP
address, an <code class="docutils literal notranslate"><span class="pre">Exception</span></code> should be raised and output similar to the following
should appear:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span><span class="p">:</span> <span class="n">Session</span> <span class="n">lookup</span> <span class="n">failure</span> <span class="n">error</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">ip</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<p>The majority of the sample code is shown below:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># IP address of the endpoint for which to apply the policy</span>
<span class="n">HOST_IP</span> <span class="o">=</span> <span class="s2">&quot;&lt;SPECIFY_IP_ADDRESS&gt;&quot;</span>

<span class="c1"># Create the client</span>
<span class="k">with</span> <span class="n">DxlClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">dxl_client</span><span class="p">:</span>

    <span class="c1"># Connect to the fabric</span>
    <span class="n">dxl_client</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connected to DXL fabric.&quot;</span><span class="p">)</span>

    <span class="c1"># Create client wrapper</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">CiscoPxGridClient</span><span class="p">(</span><span class="n">dxl_client</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Invoke &#39;apply endpoint policy by IP&#39; method on service</span>
        <span class="n">resp_dict</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">anc</span><span class="o">.</span><span class="n">apply_endpoint_policy_by_ip</span><span class="p">(</span><span class="n">HOST_IP</span><span class="p">,</span>
                                                           <span class="s2">&quot;quarantine_policy&quot;</span><span class="p">)</span>

        <span class="c1"># Print out the response (convert dictionary to JSON for pretty</span>
        <span class="c1"># printing)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Response:</span><span class="se">\n</span><span class="s2">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">MessageUtils</span><span class="o">.</span><span class="n">dict_to_json</span><span class="p">(</span><span class="n">resp_dict</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="bp">True</span><span class="p">)))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="c1"># An exception should be raised if the &#39;quarantine_policy&#39; has already</span>
        <span class="c1"># been applied to the endpoint, the &#39;quarantine_policy&#39; has not been</span>
        <span class="c1"># created, or if no session has been established for the endpoint.</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>Once a connection is established to the DXL fabric, a
<a class="reference internal" href="dxlciscopxgridclient.client.html#dxlciscopxgridclient.client.CiscoPxGridClient" title="dxlciscopxgridclient.client.CiscoPxGridClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">dxlciscopxgridclient.client.CiscoPxGridClient</span></code></a> instance is created which
will be used to communicate with Cisco pxGrid.</p>
<p>Next, the <a class="reference internal" href="dxlciscopxgridclient.client.html#dxlciscopxgridclient.client.AncClientCategory.apply_endpoint_policy_by_ip" title="dxlciscopxgridclient.client.AncClientCategory.apply_endpoint_policy_by_ip"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dxlciscopxgridclient.client.AncClientCategory.apply_endpoint_policy_by_ip()</span></code></a>
method is invoked with the IP address of the endpoint for which to apply the
<code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code>.</p>
<p>The final step is to display the contents of the returned dictionary (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
which contains the results of the attempt to apply the <code class="docutils literal notranslate"><span class="pre">quarantine_policy</span></code>
to the endpoint.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basic Apply ANC Endpoint Policy by IP Address Example</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#running">Running</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pxgridnotifications.html"
                        title="previous chapter">Enable Cisco pxGrid Notifications for DXL</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="basicancapplyendpointpolicybymacexample.html"
                        title="next chapter">Basic Apply ANC Endpoint Policy by MAC Address Example</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/basicancapplyendpointpolicybyipexample.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basicancapplyendpointpolicybymacexample.html" title="Basic Apply ANC Endpoint Policy by MAC Address Example"
             >next</a> |</li>
        <li class="right" >
          <a href="pxgridnotifications.html" title="Enable Cisco pxGrid Notifications for DXL"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Cisco pxGrid DXL Client Library 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018 McAfee LLC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>